<div ng-controller="AccessController as access">
	<div class="row">
		<div class="col-md-12">
			<div class="pull-left">
				<h1 id="Title">
					Access Management
					<small>
						Total: {{access.resource.count}}
					</small>
				</h1>
			</div>
			<div class="pull-right">
				<br/>
				<button type="button" 
					class="btn btn-primary" 
					ng-disabled="!access.selected" 
					ng-click="access.saveChanges()">
					Save Changes
				</button>
			</div>
		</div>
	</div>	
	
	<hr/>
	<div class="row">
		<div class="col-md-3">
			<table class="table table-hover">
				<thead>
					<tr>
						<th>User</th>
						<th>Role</th>
					</tr>			
				</thead>
				<tbody>
					<tr ng-repeat="row in access.resource.items" 
						class="selectable"
						ng-click="access.select(row)"
						ng-class="{'active': row === access.selected}">
						<td>{{row.prefix}} {{row.firstname}} {{row.lastname}}</td>
						<td>
							{{row.role}}
<!-- 							<select class="form-control" ng-model="row.role" ng-change="access.updateRole()">
								<option value="{{role}}" ng-repeat="role in access.roles" ng-selected="row.role === role">{{role}}</option>
							</select> -->
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="col-md-9">
			<h4 ng-if="!access.selected">Select a row to set access permissions.</h4>
			<table class="table table-hover table-bordered table-condensed"
				ng-if="access.selected">
				<thead>
					<tr>
						<th ng-repeat="action in ::access.actions">{{::action}}</th>
					</tr>			
				</thead>
				<tbody>
					<tr ng-repeat="model in ::access.models">
						<td ng-repeat="action in ::access.actions">
							<div class="checkbox">
								<label>
									<input type="checkbox" 
										ng-checked="access.isRoleSet(action, model)"
										ng-click="access.addToAccess(action, model)">{{::action}} {{::model}}
								</label>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</div>